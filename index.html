<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Light Home</title>
<style>
  /* Reset */
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    font-family: 'Segoe UI', sans-serif;
    height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    background-color:#111;
    color:white;
    text-align:center;
    transition: background 0.5s ease, box-shadow 0.5s ease;
  }

  h1 {
    font-size: 32px;
    margin-bottom: 25px;
  }

  /* Toggle Button */
  .toggle-btn {
    position: relative;
    width: 120px;
    height: 60px;
    background: #555;
    border-radius: 50px;
    cursor: pointer;
    transition: background 0.3s ease, box-shadow 0.3s ease;
    margin-bottom: 20px;
  }

  .toggle-btn.active {
    background: #ffdd33;
    box-shadow: 0 0 30px #ffdd33, 0 0 60px #ffdd33;
  }

  .toggle-circle {
    position: absolute;
    top: 5px;
    left: 5px;
    width: 50px;
    height: 50px;
    background: white;
    border-radius: 50%;
    transition: left 0.3s ease, background 0.3s ease;
  }

  .toggle-btn.active .toggle-circle {
    left: 65px;
    background: #fffbe6;
  }

  /* Status text */
  #status {
    font-size: 22px;
    margin-bottom: 25px;
    font-weight: bold;
    text-shadow: 0 0 10px #fff;
  }
</style>
</head>
<body>
<h1>ðŸ’¡ Smart Home Light</h1>

<div id="toggleBtn" class="toggle-btn">
  <div class="toggle-circle"></div>
</div>
<p id="status">Light OFF</p>

<script>
let stream;
let torchOn = false;
let usingScreen = false;

const toggleBtn = document.getElementById("toggleBtn");
const status = document.getElementById("status");

// Toggle the light function
async function toggleTorch(forceState = null){
  try {
    if(!stream){
      stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode:"environment" } });
    }
    const track = stream.getVideoTracks()[0];
    const capabilities = track.getCapabilities();

    if('torch' in capabilities){
      torchOn = forceState !== null ? forceState : !torchOn;
      await track.applyConstraints({advanced:[{torch:torchOn}]});
      usingScreen=false;
      updateUI();
    } else {
      toggleScreenLight(forceState);
    }
  } catch(err){
    toggleScreenLight(forceState);
  }
}

// Fallback for screen
function toggleScreenLight(forceState=null){
  torchOn = forceState !== null ? forceState : !torchOn;
  usingScreen = true;
  updateUI();
}

// Update UI
function updateUI(){
  if(torchOn){
    toggleBtn.classList.add("active");
    status.textContent = usingScreen ? "Screen Light ON" : "Flashlight ON";
    document.body.style.backgroundColor = "#ffdd33";
    document.body.style.boxShadow = "0 0 50px #ffdd33 inset";
  } else {
    toggleBtn.classList.remove("active");
    status.textContent = usingScreen ? "Screen Light OFF" : "Flashlight OFF";
    document.body.style.backgroundColor = "#111";
    document.body.style.boxShadow = "none";
  }
}

// Toggle button click
toggleBtn.addEventListener("click", ()=>toggleTorch());
</script>
</body>
</html>
